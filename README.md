## **Описание проекта**

*Проект разработан в рамках хакатона по кейсу от банка «Центр-Инвест»*. Цель — выявление аномальных транзакций в финансовых данных с применением методов машинного обучения.

Этот проект использует машинное обучение для выявления аномальных транзакций в финансовых данных. С помощью различных методов, таких как KNN, случайный лес и логистическая регрессия, производится анализ транзакций, чтобы определить, какие из них являются аномальными. Основная цель — улучшить безопасность и эффективность обработки транзакций.

Структура кода проекта состоит из нескольких ключевых частей, каждая из которых выполняет определённую задачу. 
### **Описание основных элементов:**

1. **Загрузка и предобработка данных**:
   - **Чтение данных**: Загружается исходный набор данных в формате CSV.
   - **Преобразование категориальных данных**: С помощью `LabelEncoder` преобразуются категориальные признаки (например, тип устройства, тип карты) в числовые значения.
   - **Создание временных признаков**: Из временной метки извлекаются новые признаки, такие как час суток и день недели.
   - **Нормализация данных**: Числовые данные (например, сумма, баланс, количество неудачных попыток ввода PIN-кода) нормализуются с использованием `MinMaxScaler`.

2. **Разделение данных**:
   - Данные делятся на обучающую и тестовую выборки с помощью `train_test_split` из библиотеки `sklearn`.

3. **Обучение модели KNN**:
   - Для модели KNN проводится обучение с использованием различных параметров: количество соседей (`n_neighbors`) и метрика расстояния (например, евклидова, манхэттеновская и другие).
   - Для оценки качества используется F1-метрика, и определяется порог для классификации аномальных данных.

4. **Параллельное обучение моделей KNN**:
   - Обучение модели KNN проводится параллельно для разных комбинаций параметров с использованием `joblib.Parallel`. Это ускоряет процесс обучения, если моделей много.

5. **Выбор лучшей модели**:
   - После параллельного обучения выбирается лучшая модель по F1-метрике.

6. **Оценка модели и предсказание аномалий**:
   - На основе лучшей модели выполняется предсказание на обучающих и тестовых данных.
   - Для оценки качества классификации используются метрики F1 и отчёт классификации.

7. **Голосование моделей**:
   - Создаётся ансамблевая модель `VotingClassifier`, которая комбинирует несколько классификаторов (например, случайный лес и логистическую регрессию) для улучшения предсказаний.
   - Модель обучается и используется для предсказания аномалий.

8. **Визуализация**:
   - Строятся визуализации для анализа результатов:
     - Аномалии по сумме и балансу транзакций.
     - Корреляционная матрица для оценки взаимосвязей между признаками и метками аномалий.

9. **Сохранение результатов**:
   - Предсказания (метки аномалий) сохраняются в CSV файл для дальнейшего анализа.

10. **Логирование**:
    - Весь процесс логируется с помощью Python `logging`, что позволяет отслеживать важные шаги и параметры на каждом этапе (загрузка данных, обучение модели, оценка и т.д.).


## _Запуск проекта_

**Клонируйте репозиторий. И главное подготовьте ваши данные и поместите их в папку с указанием пути.**

### **Процесс обучения и предсказания будет сопровождаться визуализацией:**

_Аномалии по сумме и балансу:_ Выводится диаграмма, на которой отображаются аномалии, выделенные красным цветом.

_Корреляционная матрица:_ Показывает взаимосвязь между признаками и метками аномалий.


### **Для выполнения задачи используется несколько моделей машинного обучения:**

_KNN (K-Nearest Neighbors)_ — для нахождения аномальных транзакций на основе расстояния.

_Random Forest и Logistic Regression_ — для классификации аномалий с помощью ансамблевой модели VotingClassifier.

### **Логирование**

Для отслеживания всех ключевых шагов проекта используется модуль логирования. Логи выводятся в консоль и содержат информацию о ходе загрузки данных, обучении моделей и оценке их производительности.

 ## **Требования**

Для запуска проекта потребуется Python 3.6+ и следующие библиотеки:

    pandas
    numpy
    scikit-learn
    matplotlib
    seaborn
    joblib
    logging
    
